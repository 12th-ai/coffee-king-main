<!DOCTYPE html>
<html lang="en">
<?php
    session_start();
    include '../../auth/connection.php';
    if (!isset($_SESSION['login'])) {
        echo "<script>window.location.href='../../auth/'</script>";
    }
$id = $_GET['updateId'];
$query = "SELECT * FROM blog WHERE ID = $id";
$runquery = mysqli_query($conn, $query);
$fetch = mysqli_fetch_assoc($runquery);
$writer = $fetch['Journalist'];
$pic = $fetch['Img_Name'];
$minipic = $fetch['Small_Img'];
$title = $fetch['Title'];
$summary = $fetch['Summary'];
$head = $fetch['HeadText'];
$body = $fetch['BodyText'];
$quote = $fetch['Sp_Word'];
$footer = $fetch['FooterText'];

if (isset($_POST['update'])) {
    $name = $_POST['name'];

    $pic = $_FILES['mainpic']['name'];
    $tmpname = $_FILES['mainpic']['tmp_name'];
    $path = "../../../ui/assets/blog/" . $pic;
    $mv = move_uploaded_file($tmpname, $path);

    $minipic = $_FILES['otherpic']['name'];
    $tmpmininame = $_FILES['otherpic']['tmp_name'];
    $directory = "../../../ui/assets/blog/" . $minipic;
    $mvmini = move_uploaded_file($tmpmininame, $directory);


    $title = $_POST['title'];
    $summary = $_POST['summary'];
    $header = $_POST['headtext'];
    $body = $_POST['bodytext'];
    $footer = $_POST['footertext'];
    $quote = $_POST['quotetext'];
    // $journalistname = $_POST['name'];
    $sql = mysqli_query($conn, "UPDATE blog SET Img_Name ='$pic', Small_Img = '$minipic',Journalist = '$name', Title = '$title', Summary = '$summary',HeadText  = '$head', BodyText = '$body', Sp_Word = '$quote',FooterText = '$footer' WHERE ID = $id");
    if ($sql) {
        echo "<script>alert('Blog Updated Successfully')</script>";
        echo "<script>window.location.href = 'index.php'</script>";
    } /* else {
        echo "<script>alert('Team Updating Failed')</script>";
        echo "<script>window.location.href = 'update.php?dropId='$id''</script>";
    }*/
}
?>

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blog</title>
    <link rel="stylesheet" href="../f.css">
</head>

<body>
    <div class="main">
        <nav>
            <?php 
                include "../profile.php";
            ?>
            <a href="../">
                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32">
                    <path d="M9.5 4C6.472656 4 4 6.472656 4 9.5C4 12.527344 6.472656 15 9.5 15C12.527344 15 15 12.527344 15 9.5C15 6.472656 12.527344 4 9.5 4 Z M 18 4L18 14L28 14L28 4 Z M 9.5 6C11.445313 6 13 7.554688 13 9.5C13 11.445313 11.445313 13 9.5 13C7.554688 13 6 11.445313 6 9.5C6 7.554688 7.554688 6 9.5 6 Z M 20 6L26 6L26 12L20 12 Z M 9.5 17C6.472656 17 4 19.472656 4 22.5C4 25.527344 6.472656 28 9.5 28C12.527344 28 15 25.527344 15 22.5C15 19.472656 12.527344 17 9.5 17 Z M 22.5 17C19.472656 17 17 19.472656 17 22.5C17 25.527344 19.472656 28 22.5 28C25.527344 28 28 25.527344 28 22.5C28 19.472656 25.527344 17 22.5 17 Z M 9.5 19C11.445313 19 13 20.554688 13 22.5C13 24.445313 11.445313 26 9.5 26C7.554688 26 6 24.445313 6 22.5C6 20.554688 7.554688 19 9.5 19 Z M 22.5 19C24.445313 19 26 20.554688 26 22.5C26 24.445313 24.445313 26 22.5 26C20.554688 26 19 24.445313 19 22.5C19 20.554688 20.554688 19 22.5 19Z" />
                </svg>
                Dashboard
            </a>
            <a href="../gallery/">
                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 48 48">
                    <path d="M11.5 6C8.4802259 6 6 8.4802259 6 11.5L6 36.5C6 39.519774 8.4802259 42 11.5 42L36.5 42C39.519774 42 42 39.519774 42 36.5L42 11.5C42 8.4802259 39.519774 6 36.5 6L11.5 6 z M 11.5 9L36.5 9C37.898226 9 39 10.101774 39 11.5L39 31.955078L32.988281 26.138672 A 1.50015 1.50015 0 0 0 32.986328 26.136719C32.208234 25.385403 31.18685 25 30.173828 25C29.16122 25 28.13988 25.385387 27.361328 26.138672L25.3125 28.121094L19.132812 22.142578C18.35636 21.389748 17.336076 21 16.318359 21C15.299078 21 14.280986 21.392173 13.505859 22.140625 A 1.50015 1.50015 0 0 0 13.503906 22.142578L9 26.5L9 11.5C9 10.101774 10.101774 9 11.5 9 z M 30.5 13C29.125 13 27.903815 13.569633 27.128906 14.441406C26.353997 15.313179 26 16.416667 26 17.5C26 18.583333 26.353997 19.686821 27.128906 20.558594C27.903815 21.430367 29.125 22 30.5 22C31.875 22 33.096185 21.430367 33.871094 20.558594C34.646003 19.686821 35 18.583333 35 17.5C35 16.416667 34.646003 15.313179 33.871094 14.441406C33.096185 13.569633 31.875 13 30.5 13 z M 30.5 16C31.124999 16 31.403816 16.180367 31.628906 16.433594C31.853997 16.686821 32 17.083333 32 17.5C32 17.916667 31.853997 18.313179 31.628906 18.566406C31.403816 18.819633 31.124999 19 30.5 19C29.875001 19 29.596184 18.819633 29.371094 18.566406C29.146003 18.313179 29 17.916667 29 17.5C29 17.083333 29.146003 16.686821 29.371094 16.433594C29.596184 16.180367 29.875001 16 30.5 16 z M 16.318359 24C16.578643 24 16.835328 24.09366 17.044922 24.296875 A 1.50015 1.50015 0 0 0 17.046875 24.298828L23.154297 30.207031L14.064453 39L11.5 39C10.101774 39 9 37.898226 9 36.5L9 30.673828L15.589844 24.298828C15.802764 24.093234 16.059641 24 16.318359 24 z M 30.173828 28C30.438806 28 30.692485 28.09229 30.902344 28.294922L39 36.128906L39 36.5C39 37.898226 37.898226 39 36.5 39L18.380859 39L29.447266 28.294922C29.654714 28.094207 29.910436 28 30.173828 28 z" />
                </svg>
                Gallery
            </a>
            <a href="../team/">
                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 50 50">
                    <path d="M26.8125 5C22.355469 5 19.097656 6.761719 17.375 9.375C17.019531 9.910156 16.753906 10.472656 16.53125 11.0625L16.28125 10.5625C16.117188 10.226563 15.78125 10.007813 15.40625 10C11.945313 10 9.359375 11.40625 8 13.5C6.757813 15.410156 6.683594 17.8125 7.46875 20.0625C7.40625 20.164063 7.273438 20.21875 7.21875 20.34375C7.03125 20.761719 6.929688 21.289063 7 21.90625C7 21.917969 7 21.925781 7 21.9375C7.113281 22.847656 7.34375 23.5 7.71875 24C7.878906 24.210938 8.132813 24.210938 8.34375 24.34375C8.492188 25.085938 8.703125 25.824219 9 26.4375C9.175781 26.804688 9.363281 27.121094 9.5625 27.40625C9.628906 27.503906 9.742188 27.570313 9.8125 27.65625C9.8125 28.421875 9.785156 29.109375 9.71875 30C9.539063 30.457031 9.101563 30.859375 8.28125 31.28125C7.441406 31.710938 6.316406 32.109375 5.15625 32.625C3.996094 33.140625 2.757813 33.765625 1.78125 34.78125C0.804688 35.796875 0.113281 37.21875 0 39.03125C-0.015625 39.308594 0.0820313 39.578125 0.269531 39.777344C0.460938 39.980469 0.722656 40.09375 1 40.09375L7.21875 40.09375C7.066406 40.664063 6.945313 41.277344 6.90625 41.9375C6.890625 42.214844 6.988281 42.484375 7.175781 42.683594C7.367188 42.886719 7.628906 43 7.90625 43L42.09375 43C42.371094 43 42.632813 42.886719 42.824219 42.683594C43.011719 42.484375 43.109375 42.214844 43.09375 41.9375C43.050781 41.238281 42.917969 40.601563 42.75 40L49 40C49.277344 40 49.539063 39.886719 49.730469 39.683594C49.917969 39.484375 50.015625 39.214844 50 38.9375C49.886719 37.128906 49.1875 35.703125 48.21875 34.6875C47.25 33.671875 46.054688 33.046875 44.90625 32.53125C43.757813 32.015625 42.644531 31.617188 41.8125 31.1875C41.019531 30.777344 40.597656 30.355469 40.40625 29.90625C40.339844 29.097656 40.3125 28.378906 40.3125 27.5625C40.378906 27.476563 40.496094 27.40625 40.5625 27.3125C40.761719 27.03125 40.921875 26.707031 41.09375 26.34375C41.371094 25.753906 41.574219 25.050781 41.6875 24.34375C41.890625 24.214844 42.128906 24.203125 42.28125 24C42.65625 23.5 42.886719 22.847656 43 21.9375C43.070313 21.386719 43.007813 20.871094 42.84375 20.4375C42.796875 20.316406 42.625 20.242188 42.5625 20.125C42.78125 19.613281 43.03125 19.128906 43.09375 18.5C43.183594 17.566406 43.109375 16.519531 42.84375 15.5C42.578125 14.480469 42.117188 13.46875 41.3125 12.6875C40.664063 12.054688 39.75 11.683594 38.71875 11.53125L38.3125 10.59375C38.152344 10.234375 37.796875 10.003906 37.40625 10C36.023438 10 34.550781 10.136719 33.1875 10.5625C32.832031 9.773438 32.363281 9.023438 31.71875 8.40625C30.863281 7.582031 29.660156 7.089844 28.28125 6.9375L27.71875 5.59375C27.558594 5.234375 27.203125 5.003906 26.8125 5 Z M 26.15625 7.0625L26.6875 8.21875C26.847656 8.578125 27.203125 8.808594 27.59375 8.8125C28.835938 8.8125 29.679688 9.207031 30.34375 9.84375C31.007813 10.480469 31.480469 11.386719 31.75 12.40625C32.019531 13.425781 32.09375 14.539063 32 15.46875C31.90625 16.398438 31.589844 17.148438 31.40625 17.375C31.214844 17.617188 31.148438 17.933594 31.21875 18.230469C31.292969 18.53125 31.5 18.78125 31.78125 18.90625C31.765625 18.898438 31.78125 18.898438 31.8125 18.96875C31.867188 19.097656 31.925781 19.386719 31.90625 19.75C31.902344 19.78125 31.910156 19.78125 31.90625 19.8125C31.769531 20.640625 31.535156 21.132813 31.375 21.34375C31.292969 21.453125 31.234375 21.488281 31.21875 21.5C30.746094 21.539063 30.371094 21.90625 30.3125 22.375C30.230469 23.121094 29.941406 24.09375 29.59375 24.84375C29.421875 25.21875 29.214844 25.535156 29.0625 25.75C28.945313 25.910156 28.828125 26 28.84375 26C28.507813 26.175781 28.304688 26.527344 28.3125 26.90625C28.3125 28.207031 28.304688 29.25 28.40625 30.78125C28.414063 30.878906 28.433594 30.972656 28.46875 31.0625C29.003906 32.46875 30.210938 33.316406 31.53125 33.96875C32.851563 34.621094 34.34375 35.109375 35.75 35.71875C37.15625 36.328125 38.464844 37.0625 39.40625 38.03125C40.136719 38.78125 40.582031 39.773438 40.84375 41L9.15625 41C9.417969 39.773438 9.863281 38.78125 10.59375 38.03125C11.535156 37.0625 12.84375 36.328125 14.25 35.71875C15.65625 35.109375 17.148438 34.621094 18.46875 33.96875C19.789063 33.316406 20.996094 32.46875 21.53125 31.0625C21.566406 30.972656 21.585938 30.878906 21.59375 30.78125C21.695313 29.34375 21.6875 28.207031 21.6875 26.90625C21.695313 26.527344 21.492188 26.175781 21.15625 26C21.15625 26 21.148438 25.988281 21.125 25.96875C21.117188 25.964844 21.105469 25.972656 21.09375 25.96875C21.046875 25.929688 20.980469 25.847656 20.90625 25.75C20.746094 25.539063 20.527344 25.210938 20.34375 24.84375C19.976563 24.113281 19.675781 23.1875 19.59375 22.40625C19.546875 21.96875 19.214844 21.613281 18.78125 21.53125C18.683594 21.511719 18.171875 21.535156 18 19.8125C17.929688 19.042969 18.292969 18.816406 18.25 18.84375C18.667969 18.578125 18.828125 18.046875 18.625 17.59375C17.984375 16.121094 17.78125 14.601563 18 13.1875C18.226563 12.933594 18.3125 12.578125 18.21875 12.25C18.40625 11.628906 18.671875 11.046875 19.03125 10.5C20.277344 8.613281 22.621094 7.230469 26.15625 7.0625 Z M 36.78125 12.09375L37.09375 12.78125C37.242188 13.152344 37.601563 13.398438 38 13.40625C38.890625 13.40625 39.445313 13.675781 39.90625 14.125C40.367188 14.574219 40.707031 15.242188 40.90625 16C41.105469 16.757813 41.160156 17.582031 41.09375 18.28125C41.027344 18.980469 40.789063 19.550781 40.6875 19.6875C40.511719 19.914063 40.445313 20.203125 40.5 20.484375C40.550781 20.765625 40.722656 21.011719 40.96875 21.15625C41.003906 21.246094 41.03125 21.441406 41 21.6875C40.914063 22.375 40.761719 22.710938 40.6875 22.8125C40.21875 22.871094 39.851563 23.246094 39.8125 23.71875C39.777344 24.234375 39.539063 24.953125 39.28125 25.5C39.152344 25.773438 39.019531 25.992188 38.90625 26.15625C38.820313 26.277344 38.742188 26.371094 38.75 26.375C38.480469 26.558594 38.316406 26.863281 38.3125 27.1875C38.3125 28.289063 38.300781 29.136719 38.40625 30.28125C38.417969 30.367188 38.4375 30.449219 38.46875 30.53125C38.894531 31.707031 39.855469 32.441406 40.875 32.96875C41.894531 33.496094 43.042969 33.871094 44.09375 34.34375C45.144531 34.816406 46.097656 35.375 46.78125 36.09375C47.257813 36.59375 47.574219 37.226563 47.78125 38L42 38C41.96875 38 41.9375 38 41.90625 38C41.59375 37.488281 41.242188 37.035156 40.84375 36.625C39.609375 35.355469 38.070313 34.558594 36.5625 33.90625C35.054688 33.253906 33.570313 32.75 32.4375 32.1875C31.34375 31.644531 30.691406 31.066406 30.40625 30.40625C30.332031 29.207031 30.3125 28.308594 30.3125 27.25C30.417969 27.128906 30.589844 27.039063 30.6875 26.90625C30.941406 26.550781 31.191406 26.152344 31.40625 25.6875C31.78125 24.875 32.003906 23.929688 32.15625 23C32.429688 22.835938 32.757813 22.84375 32.96875 22.5625C33.40625 21.980469 33.707031 21.175781 33.875 20.0625C33.886719 20.042969 33.898438 20.019531 33.90625 20C33.96875 19.3125 33.871094 18.699219 33.65625 18.1875C33.601563 18.058594 33.417969 18.027344 33.34375 17.90625C33.667969 17.25 33.882813 16.511719 33.96875 15.65625C34.070313 14.65625 34.035156 13.566406 33.8125 12.46875C34.710938 12.222656 35.765625 12.132813 36.78125 12.09375 Z M 14.84375 12.125L15.21875 12.84375C15.359375 13.144531 15.640625 13.355469 15.96875 13.40625C15.835938 14.859375 16.0625 16.367188 16.59375 17.8125C16.214844 18.332031 15.910156 19.027344 16 20C16.175781 21.746094 16.957031 22.574219 17.71875 23.03125C17.878906 23.988281 18.167969 24.957031 18.5625 25.75C18.792969 26.210938 19.046875 26.621094 19.3125 26.96875C19.410156 27.097656 19.582031 27.167969 19.6875 27.28125C19.6875 28.339844 19.667969 29.289063 19.59375 30.40625C19.308594 31.066406 18.65625 31.644531 17.5625 32.1875C16.429688 32.75 14.945313 33.253906 13.4375 33.90625C11.929688 34.558594 10.390625 35.355469 9.15625 36.625C8.734375 37.058594 8.355469 37.542969 8.03125 38.09375C8.019531 38.09375 8.011719 38.09375 8 38.09375L2.25 38.09375C2.460938 37.320313 2.769531 36.6875 3.25 36.1875C3.941406 35.46875 4.90625 34.910156 5.96875 34.4375C7.03125 33.964844 8.160156 33.589844 9.1875 33.0625C10.214844 32.535156 11.195313 31.835938 11.625 30.65625C11.660156 30.566406 11.679688 30.472656 11.6875 30.375C11.789063 29.136719 11.8125 28.3125 11.8125 27.3125C11.820313 26.957031 11.644531 26.625 11.34375 26.4375C11.3125 26.402344 11.246094 26.332031 11.1875 26.25C11.070313 26.082031 10.917969 25.847656 10.78125 25.5625C10.507813 24.996094 10.269531 24.261719 10.1875 23.65625C10.121094 23.210938 9.761719 22.863281 9.3125 22.8125C9.238281 22.710938 9.085938 22.375 9 21.6875C8.96875 21.402344 9.023438 21.238281 9.0625 21.15625C9.46875 20.878906 9.613281 20.351563 9.40625 19.90625C8.578125 18.03125 8.722656 16.078125 9.6875 14.59375C10.574219 13.226563 12.296875 12.28125 14.84375 12.125Z" />
                </svg>
                Team
            </a>
            <a href="" class="active">Blog</a>
        </nav>
        <div class="main-right">
            <div class="main-right-top">
                <h2>Blog</h2>
                <img src="../../../ui/assets/09/logo_black-9.png" alt="" class="logoImg">
                <a href='../../auth/handle.php?logout'>Log Out</a>
            </div>
            <div class="main-right-btm oth-right-btm">
                <form method="POST" class="full-form" enctype="multipart/form-data">
                    <h3>Update Blog</h3>
                    <div class="form-grp">
                        <div class="form-grp-in form-grp-three">
                            <div class="form-grp-inner-sp">
                                <label>Writer's Name</label>
                                <select name="name" required>
                                    <?php
                                    $query = mysqli_query($conn, "SELECT * FROM team WHERE ID = $writer");
                                    while ($row = mysqli_fetch_array($query)) {
                                        $journalistid = $row['ID'];
                                        $journalistname = $row['Names'];

                                    ?>
                                        <option value="<?php echo $journalistid ?>"><?php echo $journalistname ?></option>
                                    <?php } ?>
                                    <?php
                                    $query = mysqli_query($conn, "SELECT * FROM team WHERE ID != $writer AND Position = 'Blog Writer'");
                                    while ($row = mysqli_fetch_array($query)) {
                                        $journalistid = $row['ID'];
                                        $journalistname = $row['Names'];

                                    ?>
                                        <option value="<?php echo $journalistid ?>"><?php echo $journalistname ?></option>
                                    <?php } ?>
                                </select>
                            </div>
                            <div class="form-grp-inner-sp">
                                <div class="prev-img">
                                    <label for="">Former Image Preview</label>
                                    <img src="../../../ui/assets/blog/<?php echo $pic ?>" alt="" class="gallery-up-preview">
                                </div>
                                <label>Choose New Main Image</label>
                                <input type="file" name="mainpic" required="">
                            </div>
                            <div class="form-grp-inner-sp">
                                <div class="prev-img">
                                    <label>Former Image Preview</label>
                                    <img src="../../../ui/assets/blog/<?php echo $minipic ?>" alt="" class="gallery-up-preview">
                                </div>
                                <label>Choose Other Image</label>
                                <input type="file" name="otherpic" required="">
                            </div>
                        </div>
                    </div>
                    <div class="form-grp">
                        <div class="form-grp-in ">
                            <div class="form-grp-inner-sp">
                                <label>Title</label>
                                <textarea name="title" required placeholder="Enter Blog Title"><?php echo $title ?></textarea>
                            </div>
                            <div class="form-grp-inner-sp">
                                <label>Brief Summary</label>
                                <textarea name="summary" required placeholder="Enter Blog Preview Summary"><?php echo $summary ?></textarea>
                            </div>
                        </div>
                    </div>
                    <div class="form-grp">
                        <div class="form-grp-in ">
                            <div class="form-grp-inner-sp">
                                <label>Header Text</label>
                                <textarea name="headtext" required placeholder="Enter Header Text"><?php echo $head ?></textarea>
                            </div>
                            <div class="form-grp-inner-sp">
                                <label>Body Text</label>
                                <textarea name="bodytext" required placeholder="Enter Body Text"><?php echo $body ?></textarea>
                            </div>
                        </div>
                    </div>
                    <div class="form-grp">
                        <div class="form-grp-in ">
                            <div class="form-grp-inner-sp">
                                <label>Footer Text</label>
                                <textarea name="footertext" required placeholder="Enter Footer Text"><?php echo $footer ?></textarea>
                            </div>
                            <div class="form-grp-inner-sp">
                                <label>Quote Text</label>
                                <textarea name="quotetext" required placeholder="Enter Quote Text"><?php echo $quote ?></textarea>
                            </div>
                        </div>
                    </div>
                    <div class="btns">
                        <button type="submit" name="update" value="">Update Blog</button>
                        <button type="reset">Reset</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <script src="../js/test.js"></script>
</body>

</html>